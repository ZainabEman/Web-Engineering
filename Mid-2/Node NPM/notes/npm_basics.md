# NPM Basics

## What is NPM?

NPM (Node Package Manager) is the default package manager for Node.js. It serves two main purposes:
1. It is an online repository for publishing open-source Node.js packages
2. It is a command-line utility for installing, managing, and defining dependencies in your projects

## Why is NPM Used?

- **Dependency Management**: Easily install and update third-party libraries
- **Version Control**: Specify exact versions of dependencies to ensure consistency
- **Script Running**: Define custom scripts to automate development tasks
- **Publishing**: Share your code with others through the npm registry

## Key NPM Concepts

### package.json

The `package.json` file is the heart of any Node.js project:

```json
{
  "name": "my-project",
  "version": "1.0.0",
  "description": "A sample project",
  "main": "index.js",
  "scripts": {
    "start": "node index.js",
    "test": "jest"
  },
  "dependencies": {
    "express": "^4.17.1",
    "lodash": "^4.17.21"
  },
  "devDependencies": {
    "jest": "^27.0.0",
    "nodemon": "^2.0.7"
  }
}
```

### Dependencies vs DevDependencies

- **dependencies**: Packages required for your application to run in production
  ```bash
  npm install express --save
  # or simply
  npm install express
  ```

- **devDependencies**: Packages only needed during development or testing
  ```bash
  npm install jest --save-dev
  # or
  npm install jest -D
  ```

### Semantic Versioning

NPM uses semantic versioning (SemVer) with three numbers: `MAJOR.MINOR.PATCH`

- `^` (caret): Matches the most recent minor/patch version (e.g., `^1.2.3` matches up to `1.x.x`)
- `~` (tilde): Matches the most recent patch version (e.g., `~1.2.3` matches up to `1.2.x`)
- Exact version: Only uses the specific version (e.g., `1.2.3`)

```json
"dependencies": {
  "express": "^4.17.1",  // Any 4.x.x version (at least 4.17.1)
  "lodash": "~4.17.21",  // Any 4.17.x version (at least 4.17.21)
  "moment": "2.29.1"     // Exactly version 2.29.1
}
```

### node_modules

The `node_modules` folder contains all installed dependencies:

- It's automatically created when running `npm install`
- It should be added to `.gitignore` (not committed to version control)
- If deleted, you can recreate it by running `npm install` again
- It contains not only your direct dependencies but also their dependencies (dependency tree)

### package-lock.json

This file is automatically generated and updated when you modify `node_modules` or `package.json`:

- Locks down the exact versions of installed dependencies and their dependencies
- Ensures consistent installations across different environments
- Should be committed to version control
- Helps prevent "works on my machine" problems

```json
{
  "name": "my-project",
  "version": "1.0.0",
  "lockfileVersion": 2,
  "requires": true,
  "packages": {
    "": {
      "dependencies": {
        "express": "^4.17.1"
      }
    },
    "node_modules/express": {
      "version": "4.17.1",
      "resolved": "https://registry.npmjs.org/express/-/express-4.17.1.tgz",
      "integrity": "sha512-mHJ9O79RqluphRrcw2X/GTh3k9tVv8YcoyY4Kkh4WDMUYKRZUq0h1o0w2rrrxBqM7VoeUVqgb27xlEMXTnYt4g==",
      "dependencies": {
        "accepts": "~1.3.7",
        "array-flatten": "1.1.1",
        // ... more dependencies
      }
    },
    // ... many more nested dependencies
  }
}
```

## Common NPM Commands

### Installation

```bash
# Initialize a new project
npm init
npm init -y  # Accept all defaults

# Install dependencies
npm install                  # Install all dependencies in package.json
npm install express          # Install a specific package
npm install lodash@4.17.20   # Install a specific version
npm install --production     # Install only 'dependencies' (not 'devDependencies')

# Install global packages
npm install -g nodemon       # Install globally (available system-wide)
```

### Updating

```bash
# Check outdated packages
npm outdated

# Update packages
npm update               # Update all packages to the latest version allowed by package.json
npm update express       # Update a specific package

# Change the version constraint
npm install express@latest  # Update to the latest version and update package.json
```

### Uninstalling

```bash
npm uninstall express       # Remove from dependencies and node_modules
npm uninstall --save-dev jest  # Remove from devDependencies and node_modules
npm uninstall -g nodemon    # Uninstall a global package
```

### Running Scripts

NPM scripts are defined in the `scripts` section of `package.json`:

```json
"scripts": {
  "start": "node server.js",
  "dev": "nodemon server.js",
  "test": "jest",
  "build": "webpack"
}
```

Run them with:

```bash
npm run start  # or just 'npm start' for reserved script names
npm run dev
npm run test   # or just 'npm test'
npm run build
```

### Publishing

```bash
npm login      # Log in to npm registry
npm publish    # Publish your package
npm version patch/minor/major  # Bump version number according to semver
```

## NPM vs Yarn vs pnpm

NPM is the default package manager, but alternatives exist:

- **Yarn**: Developed by Facebook, focuses on speed, reliability, and security
- **pnpm**: Uses a shared dependencies approach to save disk space and installation time

Each has its own advantages, but they all use `package.json` as the configuration file.

## Best Practices

1. **Lock Versions**: Commit `package-lock.json` to ensure consistent installations
2. **Don't Commit node_modules**: Add it to `.gitignore`
3. **Specify Node Version**: Add `"engines"` field to `package.json` to specify compatible Node.js versions
4. **Use Exact Versions** for critical packages to prevent unexpected updates
5. **Audit Regularly**: Run `npm audit` to check for security vulnerabilities 